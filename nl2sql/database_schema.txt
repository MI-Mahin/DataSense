DATABASE: datasense

TABLES AND COLUMNS:

1. distributors
   - distributor_id (INT, PRIMARY KEY)
   - name (VARCHAR)
   - address (TEXT)
   - contact_phone (VARCHAR)
   - contact_email (VARCHAR)
   - registration_date (DATE)
   - is_active (BOOLEAN)

2. products
   - product_id (INT, PRIMARY KEY)
   - name (VARCHAR)
   - description (TEXT)
   - unit_price (DECIMAL)
   - current_stock (INT)
   - is_active (BOOLEAN)

3. orders
   - order_id (INT, PRIMARY KEY)
   - distributor_id (INT, FOREIGN KEY -> distributors)
   - order_date (TIMESTAMP)
   - status (ENUM: 'placed','invoiced','cancelled')
   - total_amount (DECIMAL)
   - notes (TEXT)

4. order_items
   - order_item_id (INT, PRIMARY KEY)
   - order_id (INT, FOREIGN KEY -> orders)
   - product_id (INT, FOREIGN KEY -> products)
   - quantity (INT)
   - price_per_unit (DECIMAL)

5. invoices
   - invoice_id (INT, PRIMARY KEY)
   - order_id (INT, FOREIGN KEY -> orders)
   - invoice_date (TIMESTAMP)
   - status (ENUM: 'invoiced','partial_delivered','fully_delivered','returned','cancelled')
   - total_amount (DECIMAL)
   - delivered_amount (DECIMAL)
   - notes (TEXT)

6. invoice_items
   - invoice_item_id (INT, PRIMARY KEY)
   - invoice_id (INT, FOREIGN KEY -> invoices)
   - product_id (INT, FOREIGN KEY -> products)
   - quantity_invoiced (INT)
   - quantity_delivered (INT)
   - price_per_unit (DECIMAL)

7. sales_returns
   - return_id (INT, PRIMARY KEY)
   - invoice_id (INT, FOREIGN KEY -> invoices)
   - return_date (TIMESTAMP)
   - reason (TEXT)
   - total_returned_amount (DECIMAL)
   - status (ENUM: 'pending','processed')
   - notes (TEXT)

8. return_items
   - return_item_id (INT, PRIMARY KEY)
   - return_id (INT, FOREIGN KEY -> sales_returns)
   - invoice_item_id (INT, FOREIGN KEY -> invoice_items)
   - quantity_returned (INT)

9. cancellations
   - cancellation_id (INT, PRIMARY KEY)
   - reference_id (INT)
   - reference_type (ENUM: 'order','invoice')
   - cancellation_date (TIMESTAMP)
   - reason (TEXT)
   - notes (TEXT)

10. vehicles
    - vehicle_id (INT, PRIMARY KEY)
    - plate_number (VARCHAR)
    - capacity (INT)
    - description (TEXT)
    - is_active (BOOLEAN)

11. load_plans
    - load_plan_id (INT, PRIMARY KEY)
    - vehicle_id (INT, FOREIGN KEY -> vehicles)
    - plan_date (TIMESTAMP)
    - status (VARCHAR)

12. load_plan_items
    - load_plan_item_id (INT, PRIMARY KEY)
    - load_plan_id (INT, FOREIGN KEY -> load_plans)
    - invoice_id (INT, FOREIGN KEY -> invoices)
    - status (VARCHAR)

13. challans
    - challan_id (INT, PRIMARY KEY)
    - load_plan_id (INT, FOREIGN KEY -> load_plans)
    - challan_date (TIMESTAMP)
    - details (JSON)

14. gate_passes
    - gate_pass_id (INT, PRIMARY KEY)
    - load_plan_id (INT, FOREIGN KEY -> load_plans)
    - gate_pass_date (TIMESTAMP)
    - details (JSON)

15. payments
    - payment_id (INT, PRIMARY KEY)
    - invoice_id (INT, FOREIGN KEY -> invoices)
    - payment_date (TIMESTAMP)
    - amount (DECIMAL)
    - method (ENUM: 'cash','cheque','bank_deposit')
    - cheque_number (VARCHAR)
    - bank_deposit_ref (VARCHAR)
    - notes (TEXT)

16. refunds
    - refund_id (INT, PRIMARY KEY)
    - invoice_id (INT, FOREIGN KEY -> invoices)
    - refund_date (TIMESTAMP)
    - amount (DECIMAL)
    - method (ENUM: 'cash','cheque','bank_deposit','credit_note')
    - reason (TEXT)
    - status (ENUM: 'pending','issued','processed')
    - reference_id (INT)
    - reference_type (VARCHAR)
    - notes (TEXT)

17. inventory_transactions
    - tx_id (INT, PRIMARY KEY)
    - product_id (INT, FOREIGN KEY -> products)
    - tx_date (TIMESTAMP)
    - tx_type (ENUM: 'production_add','sale_deduct','return_add','cancellation_add')
    - quantity (INT)
    - reference_id (INT)
    - reference_type (VARCHAR)
    - notes (TEXT)

RELATIONSHIPS:
- distributors -> orders (one-to-many)
- orders -> order_items (one-to-many)
- orders -> invoices (one-to-many)
- products -> order_items (one-to-many)
- products -> invoice_items (one-to-many)
- products -> inventory_transactions (one-to-many)
- invoices -> invoice_items (one-to-many)
- invoices -> sales_returns (one-to-many)
- invoices -> payments (one-to-many)
- invoices -> refunds (one-to-many)
- sales_returns -> return_items (one-to-many)
- vehicles -> load_plans (one-to-many)
- load_plans -> load_plan_items (one-to-many)
- load_plans -> challans (one-to-many)
- load_plans -> gate_passes (one-to-many)
