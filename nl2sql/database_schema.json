{
  "database": "datasense",
  "tables": [
    {
      "name": "distributors",
      "columns": [
        {"name": "distributor_id", "type": "INT", "primary_key": true},
        {"name": "name", "type": "VARCHAR(255)", "nullable": false},
        {"name": "address", "type": "TEXT", "nullable": false},
        {"name": "contact_phone", "type": "VARCHAR(50)"},
        {"name": "contact_email", "type": "VARCHAR(255)"},
        {"name": "registration_date", "type": "DATE", "nullable": false},
        {"name": "is_active", "type": "BOOLEAN", "default": true}
      ]
    },
    {
      "name": "products",
      "columns": [
        {"name": "product_id", "type": "INT", "primary_key": true},
        {"name": "name", "type": "VARCHAR(255)", "nullable": false, "unique": true},
        {"name": "description", "type": "TEXT"},
        {"name": "unit_price", "type": "DECIMAL(10,2)", "nullable": false},
        {"name": "current_stock", "type": "INT", "nullable": false, "default": 0},
        {"name": "is_active", "type": "BOOLEAN", "default": true}
      ]
    },
    {
      "name": "orders",
      "columns": [
        {"name": "order_id", "type": "INT", "primary_key": true},
        {"name": "distributor_id", "type": "INT", "nullable": false, "foreign_key": {"table": "distributors", "column": "distributor_id"}},
        {"name": "order_date", "type": "TIMESTAMP"},
        {"name": "status", "type": "ENUM", "values": ["placed", "invoiced", "cancelled"], "default": "placed"},
        {"name": "total_amount", "type": "DECIMAL(10,2)"},
        {"name": "notes", "type": "TEXT"}
      ]
    },
    {
      "name": "order_items",
      "columns": [
        {"name": "order_item_id", "type": "INT", "primary_key": true},
        {"name": "order_id", "type": "INT", "nullable": false, "foreign_key": {"table": "orders", "column": "order_id"}},
        {"name": "product_id", "type": "INT", "nullable": false, "foreign_key": {"table": "products", "column": "product_id"}},
        {"name": "quantity", "type": "INT"},
        {"name": "price_per_unit", "type": "DECIMAL(10,2)"}
      ]
    },
    {
      "name": "invoices",
      "columns": [
        {"name": "invoice_id", "type": "INT", "primary_key": true},
        {"name": "order_id", "type": "INT", "nullable": false, "foreign_key": {"table": "orders", "column": "order_id"}},
        {"name": "invoice_date", "type": "TIMESTAMP"},
        {"name": "status", "type": "ENUM", "values": ["invoiced", "partial_delivered", "fully_delivered", "returned", "cancelled"], "default": "invoiced"},
        {"name": "total_amount", "type": "DECIMAL(10,2)"},
        {"name": "delivered_amount", "type": "DECIMAL(10,2)", "default": 0},
        {"name": "notes", "type": "TEXT"}
      ]
    },
    {
      "name": "invoice_items",
      "columns": [
        {"name": "invoice_item_id", "type": "INT", "primary_key": true},
        {"name": "invoice_id", "type": "INT", "nullable": false, "foreign_key": {"table": "invoices", "column": "invoice_id"}},
        {"name": "product_id", "type": "INT", "nullable": false, "foreign_key": {"table": "products", "column": "product_id"}},
        {"name": "quantity_invoiced", "type": "INT"},
        {"name": "quantity_delivered", "type": "INT", "default": 0},
        {"name": "price_per_unit", "type": "DECIMAL(10,2)"}
      ]
    },
    {
      "name": "sales_returns",
      "columns": [
        {"name": "return_id", "type": "INT", "primary_key": true},
        {"name": "invoice_id", "type": "INT", "nullable": false, "foreign_key": {"table": "invoices", "column": "invoice_id"}},
        {"name": "return_date", "type": "TIMESTAMP"},
        {"name": "reason", "type": "TEXT", "nullable": false},
        {"name": "total_returned_amount", "type": "DECIMAL(10,2)"},
        {"name": "status", "type": "ENUM", "values": ["pending", "processed"], "default": "pending"},
        {"name": "notes", "type": "TEXT"}
      ]
    },
    {
      "name": "return_items",
      "columns": [
        {"name": "return_item_id", "type": "INT", "primary_key": true},
        {"name": "return_id", "type": "INT", "nullable": false, "foreign_key": {"table": "sales_returns", "column": "return_id"}},
        {"name": "invoice_item_id", "type": "INT", "nullable": false, "foreign_key": {"table": "invoice_items", "column": "invoice_item_id"}},
        {"name": "quantity_returned", "type": "INT"}
      ]
    },
    {
      "name": "cancellations",
      "columns": [
        {"name": "cancellation_id", "type": "INT", "primary_key": true},
        {"name": "reference_id", "type": "INT", "nullable": false},
        {"name": "reference_type", "type": "ENUM", "values": ["order", "invoice"]},
        {"name": "cancellation_date", "type": "TIMESTAMP"},
        {"name": "reason", "type": "TEXT", "nullable": false},
        {"name": "notes", "type": "TEXT"}
      ]
    },
    {
      "name": "vehicles",
      "columns": [
        {"name": "vehicle_id", "type": "INT", "primary_key": true},
        {"name": "plate_number", "type": "VARCHAR(50)", "nullable": false, "unique": true},
        {"name": "capacity", "type": "INT"},
        {"name": "description", "type": "TEXT"},
        {"name": "is_active", "type": "BOOLEAN", "default": true}
      ]
    },
    {
      "name": "load_plans",
      "columns": [
        {"name": "load_plan_id", "type": "INT", "primary_key": true},
        {"name": "vehicle_id", "type": "INT", "nullable": false, "foreign_key": {"table": "vehicles", "column": "vehicle_id"}},
        {"name": "plan_date", "type": "TIMESTAMP"},
        {"name": "status", "type": "VARCHAR(50)", "default": "planned"}
      ]
    },
    {
      "name": "load_plan_items",
      "columns": [
        {"name": "load_plan_item_id", "type": "INT", "primary_key": true},
        {"name": "load_plan_id", "type": "INT", "nullable": false, "foreign_key": {"table": "load_plans", "column": "load_plan_id"}},
        {"name": "invoice_id", "type": "INT", "nullable": false, "foreign_key": {"table": "invoices", "column": "invoice_id"}},
        {"name": "status", "type": "VARCHAR(50)", "default": "assigned"}
      ]
    },
    {
      "name": "challans",
      "columns": [
        {"name": "challan_id", "type": "INT", "primary_key": true},
        {"name": "load_plan_id", "type": "INT", "nullable": false, "foreign_key": {"table": "load_plans", "column": "load_plan_id"}},
        {"name": "challan_date", "type": "TIMESTAMP"},
        {"name": "details", "type": "JSON"}
      ]
    },
    {
      "name": "gate_passes",
      "columns": [
        {"name": "gate_pass_id", "type": "INT", "primary_key": true},
        {"name": "load_plan_id", "type": "INT", "nullable": false, "foreign_key": {"table": "load_plans", "column": "load_plan_id"}},
        {"name": "gate_pass_date", "type": "TIMESTAMP"},
        {"name": "details", "type": "JSON"}
      ]
    },
    {
      "name": "payments",
      "columns": [
        {"name": "payment_id", "type": "INT", "primary_key": true},
        {"name": "invoice_id", "type": "INT", "nullable": false, "foreign_key": {"table": "invoices", "column": "invoice_id"}},
        {"name": "payment_date", "type": "TIMESTAMP"},
        {"name": "amount", "type": "DECIMAL(10,2)"},
        {"name": "method", "type": "ENUM", "values": ["cash", "cheque", "bank_deposit"]},
        {"name": "cheque_number", "type": "VARCHAR(100)"},
        {"name": "bank_deposit_ref", "type": "VARCHAR(100)"},
        {"name": "notes", "type": "TEXT"}
      ]
    },
    {
      "name": "refunds",
      "columns": [
        {"name": "refund_id", "type": "INT", "primary_key": true},
        {"name": "invoice_id", "type": "INT", "nullable": false, "foreign_key": {"table": "invoices", "column": "invoice_id"}},
        {"name": "refund_date", "type": "TIMESTAMP"},
        {"name": "amount", "type": "DECIMAL(10,2)"},
        {"name": "method", "type": "ENUM", "values": ["cash", "cheque", "bank_deposit", "credit_note"]},
        {"name": "reason", "type": "TEXT"},
        {"name": "status", "type": "ENUM", "values": ["pending", "issued", "processed"], "default": "pending"},
        {"name": "reference_id", "type": "INT"},
        {"name": "reference_type", "type": "VARCHAR(50)"},
        {"name": "notes", "type": "TEXT"}
      ]
    },
    {
      "name": "inventory_transactions",
      "columns": [
        {"name": "tx_id", "type": "INT", "primary_key": true},
        {"name": "product_id", "type": "INT", "nullable": false, "foreign_key": {"table": "products", "column": "product_id"}},
        {"name": "tx_date", "type": "TIMESTAMP"},
        {"name": "tx_type", "type": "ENUM", "values": ["production_add", "sale_deduct", "return_add", "cancellation_add"]},
        {"name": "quantity", "type": "INT"},
        {"name": "reference_id", "type": "INT"},
        {"name": "reference_type", "type": "VARCHAR(50)"},
        {"name": "notes", "type": "TEXT"}
      ]
    }
  ]
}
